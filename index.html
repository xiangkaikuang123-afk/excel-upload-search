<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Rename Generator from Excel</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
  <h2>Upload Excel File to Generate Rename Script</h2>
  <input type="file" id="upload" accept=".xlsx, .xls" />
  <button onclick="generate()">Generate Rename Script</button>
  <pre id="output" style="white-space: pre-wrap; background: #f0f0f0; padding: 10px;"></pre>
  <a id="downloadLink" style="display: none;">Download Rename Script</a>

  <script>
    let renameCommands = '';

    function generate() {
      const fileInput = document.getElementById('upload');
      const file = fileInput.files[0];
      if (!file) {
        alert("Please upload an Excel file.");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
        const rows = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

        renameCommands = '';
        for (let i = 1; i < rows.length; i++) {
          const fileNum = rows[i][0];
          const suffix = rows[i][1];
          if (fileNum && suffix) {
            const oldName = fileNum.toString().trim();
            const newName = `${oldName}-${suffix.toString().trim()}.pdf`;
            renameCommands += `rename "${oldName}" "${newName}"\n`;
          }
        }

        document.getElementById('output').textContent = renameCommands;

        // Create downloadable .bat file
        const blob = new Blob([renameCommands], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const link = document.getElementById('downloadLink');
        link.href = url;
        link.download = 'rename_script.bat';
        link.style.display = 'inline-block';
        link.textContent = 'Download Rename Script (.bat)';
      };
      reader.readAsArrayBuffer(file);
    }
  </script>
</body>
</html>
